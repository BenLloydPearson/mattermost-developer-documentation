<!DOCTYPE html>





<html>
    <head>
        <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title> Apps</title>
<meta name="viewport" content="width=device-width, initial-scale=1">  
<meta http-equiv="content-language" content="en-us" />

<meta name="og:site_name" value="Mattermost.com">
<meta name="og:title" value="Apps">

 
  <meta name="description" content="Mattermost Apps.">
<meta name="twitter:description" content="Mattermost Apps.">
<meta name="og:description" content="Mattermost Apps.">



 
<link rel="canonical" href="https://developers.mattermost.com/integrate/apps/">


<link rel="shortcut icon" type="image/png" href="https://developers.mattermost.com/img/favicon-32x32.png" />

<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600" rel="stylesheet">


<link rel="stylesheet" href="https://developers.mattermost.com/css/bootstrap.min.css">
<link rel="stylesheet" href="https://developers.mattermost.com/css/tabs.css">
<link rel="stylesheet" href="https://developers.mattermost.com/css/bar.css">
<link rel="stylesheet" href="https://developers.mattermost.com/css/styles.css">
<link rel="stylesheet" href="https://developers.mattermost.com/css/code.css">
<link rel="stylesheet" href="https://developers.mattermost.com/css/note.css">

<script async defer src="https://buttons.github.io/buttons.js"></script>


<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-53S4TVZ');</script>


    </head>
<body>
    
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-53S4TVZ"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>


    
<header class="with-notification-bar">

    <a href="https://developers.mattermost.com/"><img src="https://developers.mattermost.com/img/logo.svg" alt="Mattermost Logo" width="212px"></a>
    <div class="header__menu-toggle">
        <i class="fa fa-bars"></i>
    </div>
    <ul class="header__links--right">
        <li><a href="https://developers.mattermost.com/">Home</a></li>
        
            
            
            
                
                    <li><a href="https://developers.mattermost.com/contribute/getting-started/">Contribute</a></li>
                
            
        
            
            
            
                
                    <li class="active"><a href="https://developers.mattermost.com/integrate/getting-started/">Integrate</a></li>
                
            
        
            
            
            
                
                    <li><a href="https://developers.mattermost.com/extend/getting-started/">Extend</a></li>
                
            
        
            
            
            
        
            
            
            
                
                    <li><a href="https://developers.mattermost.com/blog/">Blog</a></li>
                
            
        
            
            
            
                
                    <li><a href="https://docs.mattermost.com/">Admin Docs</a></li>
                
            
        
    </ul>
</header>


<div class='notification-bar sticky-top'>
    <div class="notification-bar__content">
        <a class="notification-bar__close">
            <span aria-hidden="true">×</span>
        </a>
        <a href="https://mattermost.com/careers">
            We&#39;re hiring!
        </a>
    </div>
</div>




    <div id="wrapper">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-3 sidebar">
    <div class="sidebar__menu-toggle">
        Apps
        <i class="fa fa-bars pull-right"></i>
    </div>
    <div class="row sidebar__links">
        
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style=""></i>
                    
                        <a href="https://developers.mattermost.com/integrate/getting-started/"> Getting Started</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="https://developers.mattermost.com/integrate/getting-started/how-should-i-integrate/"> How Should I Integrate?</a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                </ul>
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                    
                        <a href="https://developers.mattermost.com/integrate/incoming-webhooks/"> Incoming Webhooks</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                </ul>
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                    
                        <a href="https://developers.mattermost.com/integrate/outgoing-webhooks/"> Outgoing Webhooks</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                </ul>
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                    
                        <a href="https://developers.mattermost.com/integrate/slash-commands/"> Slash Commands</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                </ul>
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                    
                        <a href="https://developers.mattermost.com/integrate/rest-api/"> API Reference</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                </ul>
            
                
                

                
                
                    
                

                
                    
                

                <span class="item active">
                    <i class="sub-menu__toggle fa fa-minus-square-o" aria-hidden="true" style=""></i>
                    
                        <a class="active" href="#"> Apps</a>
                    
                </span>
                <ul class="sub-menu" style="display: block">
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="https://developers.mattermost.com/integrate/apps/anatomy-hello/"> </a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="https://developers.mattermost.com/integrate/apps/app-lifecycle/"> </a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="https://developers.mattermost.com/integrate/apps/example-interactivity/"> </a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="https://developers.mattermost.com/integrate/apps/example-post-menu/"> </a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="https://developers.mattermost.com/integrate/apps/overview/"> </a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="https://developers.mattermost.com/integrate/apps/quickstart/"> </a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="https://developers.mattermost.com/integrate/apps/using-mattermost-api/"> </a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                        
                        

                        
                        

                        
                            
                        

                        <span class="item ">
                            <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                            
                                <a href="https://developers.mattermost.com/integrate/apps/using-third-party-api/"> </a></span>
                            
                        </span>
                        <ul class="sub-menu" >
                            
                        </ul>
                    
                </ul>
            
                
                

                
                

                
                    
                

                <span class="item ">
                    <i class="sub-menu__toggle fa fa-plus-square-o" aria-hidden="true" style="display: none"></i>
                    
                        <a href="https://developers.mattermost.com/integrate/examples/"> Examples</a>
                    
                </span>
                <ul class="sub-menu" >
                    
                </ul>
            
        
    </div>
</div>

                <div class="col-lg-9 doc-content">
                    
<a href="https://github.com/mattermost/mattermost-developer-documentation/edit/master/site/content/integrate/apps/_index.md" class="float-right edit-github">
    Edit on GitHub
</a>


                    <h1 class="mt-0 doc-title">
                        
                            Mattermost Apps
                        
                    </h1>
                    <h1 id="overview">Overview&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#overview"></i></a> </h1>
<p>Apps are lightweight interactive add-ons to mattermost. Apps can:</p>
<ul>
<li>Display interactive, dynamic Modal forms and Message Actions.</li>
<li>Attach themselves to locations in the Mattermost UI (e.g. channel bar buttons, post menu, channel menu, commands), and can add their custom /commands with full Autocomplete.</li>
<li>Receive webhooks from Mattermost, and from 3rd parties, and use the Mattermost REST APIs to post messages, etc.</li>
<li>Be hosted externally (HTTP), on Mattermost Cloud (AWS Lambda), and soon on-prem and in customers&rsquo; own AWS environments.</li>
<li>Be developed in any language*.</li>
</ul>
<h1 id="contents">Contents&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#contents"></i></a> </h1>
<h2 id="development-environment">Development environment&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#development-environment"></i></a> </h2>
<ul>
<li>DRAFT <a href="https://docs.google.com/document/d/1-o9A8l65__rYbx6O-ZdIgJ7LJgZ1f3XRXphAyD7YfF4/edit#">Google Doc</a> - Dev environment doc.</li>
</ul>
<h2 id="hello-world">Hello, World&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#hello-world"></i></a> </h2>
<ul>
<li><a href="01-anatomy-hello.md">Anatomy</a> of a simple app.</li>
</ul>
<h2 id="functions-calls">Functions, Calls&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#functions-calls"></i></a> </h2>
<ul>
<li>Example: <a href="https://developers.mattermost.com/server/examples/go/helloworld/hello.go#L45">Hello, World</a> <code>send</code> function.</li>
<li><a href="02-example-post-menu.md">Post Menu Message Flow</a> - message flow to define a Post Menu action, then have a user click it.</li>
<li>godoc: <a href="https://pkg.go.dev/github.com/mattermost/mattermost-plugin-apps/apps#Call">Call</a> -
<a href="http://localhost:6060/pkg/github.com/mattermost/mattermost-plugin-apps/apps#Call">local</a> - describes how to call a function.</li>
<li>godoc: <a href="https://pkg.go.dev/github.com/mattermost/mattermost-plugin-apps/apps#CallRequest">CallRequest</a> -
<a href="http://localhost:6060/pkg/github.com/mattermost/mattermost-plugin-apps/apps#CallRequest">local</a> - structure of a request to a function.</li>
<li>godoc: <a href="https://pkg.go.dev/github.com/mattermost/mattermost-plugin-apps/apps#Context">Context</a> -
<a href="http://localhost:6060/pkg/github.com/mattermost/mattermost-plugin-apps/apps#Context">local</a> - extra data passed to call requests.</li>
<li>godoc: <a href="https://pkg.go.dev/github.com/mattermost/mattermost-plugin-apps/apps#Expand">Expand</a> -
<a href="http://localhost:6060/pkg/github.com/mattermost/mattermost-plugin-apps/apps#Expand">local</a> - controls context expansion.</li>
</ul>
<h2 id="forms">Forms&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#forms"></i></a> </h2>
<ul>
<li>Example: <a href="https://developers.mattermost.com/server/examples/go/helloworld/send_form.json">Hello, World</a> <code>send</code> form.</li>
<li><a href="03-example-interactivity.md">Interactive Message Flows</a> - message flow to define a Post Menu action, then have a user click it.</li>
<li>godoc <a href="https://pkg.go.dev/github.com/mattermost/mattermost-plugin-apps/apps#Form">Form</a> - <a href="http://localhost:6060/pkg/github.com/mattermost/mattermost-plugin-apps/apps#Form">local</a></li>
<li>godoc <a href="https://pkg.go.dev/github.com/mattermost/mattermost-plugin-apps/apps#Field">Field</a> - <a href="http://localhost:6060/pkg/github.com/mattermost/mattermost-plugin-apps/apps#Field">local</a></li>
</ul>
<h2 id="bindings-and-locations">Bindings and Locations&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#bindings-and-locations"></i></a> </h2>
<ul>
<li>Example: <a href="https://developers.mattermost.com/server/examples/go/helloworld/bindings.json">Hello, World</a> bindings.</li>
<li>godoc <a href="https://pkg.go.dev/github.com/mattermost/mattermost-plugin-apps/apps#Binding">Binding</a> - <a href="http://localhost:6060/pkg/github.com/mattermost/mattermost-plugin-apps/apps#Binding">local</a></li>
</ul>
<h2 id="autocomplete">Autocomplete&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#autocomplete"></i></a> </h2>
<ul>
<li>Example: <a href="https://developers.mattermost.com/server/examples/go/helloworld/bindings.json">Hello, World</a> bindings.</li>
</ul>
<h2 id="modals">Modals&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#modals"></i></a> </h2>
<ul>
<li>Example: <a href="https://developers.mattermost.com/server/examples/go/helloworld/send_form.json">Hello, World</a> <code>send</code> form.</li>
</ul>
<h2 id="in-post-interactivity">In-Post Interactivity&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#in-post-interactivity"></i></a> </h2>
<h2 id="using-mattermost-apis05-using-mattermost-apimd"><a href="05-using-mattermost-api.md">Using Mattermost APIs</a>&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#using-mattermost-apis05-using-mattermost-apimd"></i></a> </h2>
<h2 id="using-3rd-party-apis06-using-3rdparty-apimd"><a href="06-using-3rdparty-api.md">Using 3rd party APIs</a>&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#using-3rd-party-apis06-using-3rdparty-apimd"></i></a> </h2>
<h2 id="app-lifecycle">App Lifecycle&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#app-lifecycle"></i></a> </h2>
<ul>
<li><a href="07-lifecycle.md">App Lifecycle</a></li>
<li>godoc: <a href="https://pkg.go.dev/github.com/mattermost/mattermost-plugin-apps/cmd/appsctl">appsctl</a> - CLI tool used to provision Mattermost Apps in development and production.</li>
</ul>
<h1 id="hello-world-1">Hello World!&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#hello-world-1"></i></a> </h1>
<p>Here is an example of an HTTP App (<a href="https://developers.mattermost.com/examples/go/helloworld">source</a>),
written in Go and runnable on http://localhost:8080.</p>
<ul>
<li>It contains a <code>manifest.json</code>, declares itself an HTTP application that acts
as a bot and attaches to locations in UI.</li>
<li>In its <code>bindings</code> function it attaches <code>send-modal</code> to a button in the channel
header, and <code>send</code> to a /helloworld command</li>
<li>It contains a <code>send</code> function that sends a parameterized message back to the
user.</li>
<li>It contains a <code>send-modal</code> function that forces displaying the <code>send</code> form as
a Modal.</li>
</ul>
<p>To install &ldquo;Hello, World&rdquo; on a locally-running instance of Mattermost follow
these steps (go 1.16 is required):</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#366">cd</span> .../mattermost-plugin-apps/examples/go/helloworld
go run . 
</code></pre></div><p>In Mattermost desktop app run:</p>
<pre><code>/apps debug-add-manifest --url http://localhost:8080/manifest.json
/apps install --app-id helloworld
</code></pre><p>Then you can try clicking the &ldquo;Hello World&rdquo; channel header button, which brings up a modal:
<img src="https://user-images.githubusercontent.com/1187448/110829345-da81d800-824c-11eb-96e7-c62637242897.png" alt="image">
type <code>testing</code> and click Submit, you should see:
<img src="https://user-images.githubusercontent.com/1187448/110829449-fb4a2d80-824c-11eb-8ade-d20e0fbd1b94.png" alt="image"></p>
<p>You can also use <code>/helloworld send</code> command.</p>
<h2 id="manifest">Manifest&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#manifest"></i></a> </h2>
<p>The manifest declares App metadata, For HTTP apps like this no paths mappings
are needed. The Hello World App requests the <em>permission</em> to act as a Bot, and
to <em>bind</em> itself to the channel header, and to /commands.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
	<span style="color:#309;font-weight:bold">&#34;app_id&#34;</span>: <span style="color:#c30">&#34;helloworld&#34;</span>,
	<span style="color:#309;font-weight:bold">&#34;display_name&#34;</span>: <span style="color:#c30">&#34;Hello, world!&#34;</span>,
	<span style="color:#309;font-weight:bold">&#34;app_type&#34;</span>: <span style="color:#c30">&#34;http&#34;</span>,
	<span style="color:#309;font-weight:bold">&#34;root_url&#34;</span>: <span style="color:#c30">&#34;http://localhost:8080&#34;</span>,
	<span style="color:#309;font-weight:bold">&#34;requested_permissions&#34;</span>: [
		<span style="color:#c30">&#34;act_as_bot&#34;</span>
	],
	<span style="color:#309;font-weight:bold">&#34;requested_locations&#34;</span>: [
		<span style="color:#c30">&#34;/channel_header&#34;</span>,
		<span style="color:#c30">&#34;/command&#34;</span>
	]
}
</code></pre></div><h2 id="bindings-and-locations-1">Bindings and Locations&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#bindings-and-locations-1"></i></a> </h2>
<p>Locations are named elements in Mattermost UI. Bindings specify how App&rsquo;s calls
should be displayed at, and invoked from these locations.</p>
<p>The Hello App creates a Channel Header button, and adds a <code>/helloworld send</code> command.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
	<span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;ok&#34;</span>,
	<span style="color:#309;font-weight:bold">&#34;data&#34;</span>: [
		{
			<span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;/channel_header&#34;</span>,
			<span style="color:#309;font-weight:bold">&#34;bindings&#34;</span>: [
				{
					<span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;send-button&#34;</span>,
					<span style="color:#309;font-weight:bold">&#34;icon&#34;</span>: <span style="color:#c30">&#34;http://localhost:8080/static/icon.png&#34;</span>,
					<span style="color:#309;font-weight:bold">&#34;label&#34;</span>:<span style="color:#c30">&#34;send hello message&#34;</span>,
					<span style="color:#309;font-weight:bold">&#34;call&#34;</span>: {
						<span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/send-modal&#34;</span>
					}
				}
			]
		},
		{
			<span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;/command&#34;</span>,
			<span style="color:#309;font-weight:bold">&#34;bindings&#34;</span>: [
				{
					<span style="color:#309;font-weight:bold">&#34;icon&#34;</span>: <span style="color:#c30">&#34;http://localhost:8080/static/icon.png&#34;</span>,
					<span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;helloworld&#34;</span>,
					<span style="color:#309;font-weight:bold">&#34;description&#34;</span>: <span style="color:#c30">&#34;Hello World app&#34;</span>,
					<span style="color:#309;font-weight:bold">&#34;hint&#34;</span>:        <span style="color:#c30">&#34;[send]&#34;</span>,
					<span style="color:#309;font-weight:bold">&#34;bindings&#34;</span>: [
						{
							<span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;send&#34;</span>,
							<span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;send&#34;</span>,
							<span style="color:#309;font-weight:bold">&#34;call&#34;</span>: {
								<span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/send&#34;</span>
							}
						}
					]
				}
			]
		}
	]
}
</code></pre></div><h2 id="functions-and-form">Functions and Form&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#functions-and-form"></i></a> </h2>
<p>Functions handle user events and webhooks. The Hello World App exposes 2 functions:</p>
<ul>
<li><code>/send</code> that services the command and modal.</li>
<li><code>/send-modal</code> that forces the modal to be displayed.</li>
</ul>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#069;font-weight:bold">func</span> <span style="color:#c0f">main</span>() {
	<span style="color:#09f;font-style:italic">// Serve its own manifest as HTTP for convenience in dev. mode.
</span><span style="color:#09f;font-style:italic"></span>	http.<span style="color:#c0f">HandleFunc</span>(<span style="color:#c30">&#34;/manifest.json&#34;</span>, <span style="color:#c0f">writeJSON</span>(manifestData))

	<span style="color:#09f;font-style:italic">// Returns the Channel Header and Command bindings for the App.
</span><span style="color:#09f;font-style:italic"></span>	http.<span style="color:#c0f">HandleFunc</span>(<span style="color:#c30">&#34;/bindings&#34;</span>, <span style="color:#c0f">writeJSON</span>(bindingsData))

	<span style="color:#09f;font-style:italic">// The form for sending a Hello message.
</span><span style="color:#09f;font-style:italic"></span>	http.<span style="color:#c0f">HandleFunc</span>(<span style="color:#c30">&#34;/send/form&#34;</span>, <span style="color:#c0f">writeJSON</span>(formData))

	<span style="color:#09f;font-style:italic">// The main handler for sending a Hello message.
</span><span style="color:#09f;font-style:italic"></span>	http.<span style="color:#c0f">HandleFunc</span>(<span style="color:#c30">&#34;/send/submit&#34;</span>, send)

	<span style="color:#09f;font-style:italic">// Forces the send form to be displayed as a modal.
</span><span style="color:#09f;font-style:italic"></span>	<span style="color:#09f;font-style:italic">// TODO: ticket: this should be unnecessary.
</span><span style="color:#09f;font-style:italic"></span>	http.<span style="color:#c0f">HandleFunc</span>(<span style="color:#c30">&#34;/send-modal/submit&#34;</span>, <span style="color:#c0f">writeJSON</span>(formData))

	<span style="color:#09f;font-style:italic">// Serves the icon for the App.
</span><span style="color:#09f;font-style:italic"></span>	http.<span style="color:#c0f">HandleFunc</span>(<span style="color:#c30">&#34;/static/icon.png&#34;</span>, <span style="color:#c0f">writeData</span>(<span style="color:#c30">&#34;image/png&#34;</span>, iconData))

	http.<span style="color:#c0f">ListenAndServe</span>(<span style="color:#c30">&#34;:8080&#34;</span>, <span style="color:#069;font-weight:bold">nil</span>)
}

<span style="color:#069;font-weight:bold">func</span> <span style="color:#c0f">send</span>(w http.ResponseWriter, req <span style="color:#555">*</span>http.Request) {
	c <span style="color:#555">:=</span> apps.CallRequest{}
	json.<span style="color:#c0f">NewDecoder</span>(req.Body).<span style="color:#c0f">Decode</span>(<span style="color:#555">&amp;</span>c)

	message <span style="color:#555">:=</span> <span style="color:#c30">&#34;Hello, world!&#34;</span>
	v, ok <span style="color:#555">:=</span> c.Values[<span style="color:#c30">&#34;message&#34;</span>]
	<span style="color:#069;font-weight:bold">if</span> ok <span style="color:#555">&amp;&amp;</span> v <span style="color:#555">!=</span> <span style="color:#069;font-weight:bold">nil</span> {
		message <span style="color:#555">+=</span> fmt.<span style="color:#c0f">Sprintf</span>(<span style="color:#c30">&#34; ...and %s!&#34;</span>, v)
	}
	mmclient.<span style="color:#c0f">AsBot</span>(c.Context).<span style="color:#c0f">DM</span>(c.Context.ActingUserID, message)

	json.<span style="color:#c0f">NewEncoder</span>(w).<span style="color:#c0f">Encode</span>(apps.CallResponse{})
}
</code></pre></div><p>The functions use a simple form with 1 text field named <code>&quot;message&quot;</code>, the form
submits to <code>/send</code>.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
	<span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;form&#34;</span>,
	<span style="color:#309;font-weight:bold">&#34;form&#34;</span>: {
		<span style="color:#309;font-weight:bold">&#34;title&#34;</span>: <span style="color:#c30">&#34;Hello, world!&#34;</span>,
		<span style="color:#309;font-weight:bold">&#34;icon&#34;</span>: <span style="color:#c30">&#34;http://localhost:8080/static/icon.png&#34;</span>,
		<span style="color:#309;font-weight:bold">&#34;fields&#34;</span>: [
			{
				<span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;text&#34;</span>,
				<span style="color:#309;font-weight:bold">&#34;name&#34;</span>: <span style="color:#c30">&#34;message&#34;</span>,
				<span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;message&#34;</span>
			}
		],
		<span style="color:#309;font-weight:bold">&#34;call&#34;</span>: {
			<span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/send&#34;</span>
		}
	}
}
</code></pre></div><h2 id="icons">Icons&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#icons"></i></a> </h2>
<p>Apps may include static assets. At the moment, only icons are used.</p>
<h1 id="app-lifecycle-1">App Lifecycle&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#app-lifecycle-1"></i></a> </h1>
<h2 id="app-bundle">App Bundle&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#app-bundle"></i></a> </h2>
<p>An app bundle is a convenient way to deliver an app to the Mattermost ecosystem. It provides a way to organize code and resources needed for an app to run. An app bundle is created by the developer of the app. Mattermost uses app bundles to provision and install/uninstall apps.</p>
<p>The app bundle contains a <code>manifest.json</code> file, a <code>static/</code> folder (optional), and one or several lambda function bundles.</p>
<ul>
<li>The <code>static/</code> folder contains all the static files the app needs. For the Mattermost AWS apps static files are automatically provisioned and stored in the dedicated AWS S3 bucket. Apps have unlimited access to them by providing the static file name to the Apps Plugin. For the third-party hosted AWS apps, static files are stored in the different S3 bucket (specified by the third-party). For the HTTP Apps, when creating a server, the developer should store the static files in the <code>/static/$FILE_NAME</code> relative URL.</li>
<li>The <code>manifest.json</code> file contains details about the app such as appID, appVersion, appType (HTTP or an AWS app), requested permissions, requested locations, and information about the functions such as function path, name, runtime and handler.</li>
<li>Each of the lambda function bundles is a valid and runnable AWS Lambda function, which are provisioned in the AWS by the <a href="https://github.com/mattermost/mattermost-apps-cloud-deployer">Mattermost Apps Cloud Deployer</a>. The AWS Lambda function bundle is a <code>.zip</code> file which contains scripts or compiled programs and their dependencies. Note that it must be less than 50 MB.Exact specification of the bundle varies for different runtimes. For example one can see more details for <code>node.js</code> bundles <a href="https://docs.aws.amazon.com/lambda/latest/dg/nodejs-package.html">here</a>.</li>
</ul>
<h2 id="development">Development&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#development"></i></a> </h2>
<h2 id="submit-to-marketplace">Submit to Marketplace&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#submit-to-marketplace"></i></a> </h2>
<h2 id="provision">Provision&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#provision"></i></a> </h2>
<h3 id="provisioning-in-third-party-aws">Provisioning in third-party AWS&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#provisioning-in-third-party-aws"></i></a> </h3>
<p>Note that third-party apps are not supported in the Mattermost Cloud, they are used only for developer testing convenience. Provisioning in the third party AWS cloud environment is done by the <strong>appsctl</strong> tool using the command:</p>
<p><code>go run ./cmd/appsctl/ provision app /PATH/TO/YOUR/APP/BUNDLE</code></p>
<p>It reads appropriate AWS credentials from environment variables:</p>
<p><code>APPS_PROVISION_AWS_ACCESS_KEY</code></p>
<p><code>APPS_PROVISION_AWS_SECRET_KEY</code></p>
<p>We need an app bundle to provision an app. The bundle might be provisioned from the local disk, from S3 (not implemented yet) or from some URL (not implemented yet). Provisioning consists of three parts:</p>
<ol>
<li>Creating the lambda functions with appropriate policies.</li>
<li>Storing static assets in the dedicated S3 bucket.</li>
<li>Storing app’s manifest file in the same dedicated S3 bucket.</li>
</ol>
<p>AWS Lambda functions have semantic names, which means that a function described in the manifest.json file translates to AWS as <code>$appID_$appVersion_$functionName</code> to avoid collisions with other apps&rsquo; or other versions&rsquo; functions. And <strong>appsctl</strong> provisions lambda functions using this name. For example a name of a <code>servicenow</code> app&rsquo;s lambda function might be <code>com-mattermost-servicenow_0-1-0_go-function</code>. App developer does not need to worry about the AWS lambda function names, Apps Plugin takes care of it. Dedicated S3 bucket name is stored in the environment variable:</p>
<p><code>MM_APPS_S3_BUCKET</code></p>
<p>which stores all apps&rsquo; static assets and manifest files.</p>
<p>All files in the static folder of the bundle are considered to be the app&rsquo;s static assets and are stored in the above mentioned bucket. Stored assets also have semantic keys and are generated using the rule - <code>static/$appID_$appVersion/filename</code>. For example <code>servicenow</code> app&rsquo;s static file key can be <code>&quot;static/com.mattermost.servicenow_0.1.0_app/photo.png&quot;</code>. App developer does not need to worry about the static asset keys, Apps Plugin takes care of it.</p>
<p>The <code>manifest.json</code> file of an app is stored in the same S3 bucket as well with the key - <code>manifests/$appID_$appVersion.json</code>.</p>
<p><img src="imgs/provisioning-in-3rd-party-aws.png" alt=""></p>
<h3 id="provisioning-in-mattermost-aws-cloud">Provisioning In Mattermost AWS Cloud&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#provisioning-in-mattermost-aws-cloud"></i></a> </h3>
<p>To be provisioned in AWS Mattermost Cloud an app bundle is uploaded to the specific S3 bucket. On a new app release, a bundle is created by the circleCI and uploaded to S3. <a href="https://github.com/mattermost/mattermost-apps-cloud-deployer">Mattermost apps cloud deployer</a>, running as a k8s cron job every hour, detects the S3 upload, creates appropriate lambda functions, assets, and manifest the same way the <strong>appsclt</strong> does for the third-party accounts.</p>
<p>The deployer needs lambda function names, asset keys, and manifest key to provision the app. It calls the <code>aws.GetProvisionDataFromFile(/PATH/TO/THE/APP/BUNDLE)</code> from the Apps Plugin to get the provision data. Same data can be generated using the command:</p>
<p><code>go run ./cmd/appsctl/ generate-terraform-data /PATH/TO/YOUR/APP/BUNDLE</code></p>
<p><img src="imgs/provisioning-in-mm-aws.png" alt=""></p>
<h2 id="publish">Publish&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#publish"></i></a> </h2>
<p>Publishing or registering an app in a Mattermost installation means the app will be shown in the Marketplace of the installation and it can be later installed by the System Admin and used by the users. On a totally new app registration or on a registration of the new version of the already registered app, a new version of the Apps Plugin is cut. The <code>manifests.json</code> file is updated and a new app is added in the listing. Later, the plugin is installed in the appropriate installations (using feature flags if necessary).</p>
<p>After the plugin update Apps Plugin synchronizes the list of the registered apps by downloading appropriate manifests from the S3 and storing them in memory. So the Marketplace shows renewed app listings and sysadmin can install a new app(or new version). It is worth mentioning here that Apps Plugin needs AWS credentials to download from S3 as well as to invoke lambda functions. Those credentials are read from the following environment variables:</p>
<p><code>APPS_INVOKE_AWS_ACCESS_KEY</code></p>
<p><code>APPS_INVOKE_AWS_SECRET_KEY</code></p>
<h2 id="install">Install&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#install"></i></a> </h2>
<p>Installing is a process when sysadmin installs provisioned and already registered/published apps in their Mattermost installation. As mentioned above list of the registered apps are in the memory of the Apps Plugin. Whenever the System Admin executes an <code>/install</code> slash command or selects <strong>Install</strong> in the Marketplace appropriate permissions are requested and the app is installed. A bot and an OAuth app are created on installation, <code>OnInstall</code> call is sent to the app(relevant lambda function) as well.</p>
<p><img src="imgs/install-mm-aws-app.png" alt=""></p>
<p>Apps are installed with <code>apps install</code>:</p>
<ul>
<li>Manifest -&gt; Installed App
<ul>
<li>Consent to permissions, locations, OAuth app type</li>
<li>Create Bot+Access Token, OAuth App</li>
<li>HTTP: collect app’s JWT secret</li>
</ul>
</li>
<li>Invoke “OnInstall” callback on the App
<ul>
<li>Admin access token</li>
</ul>
</li>
<li>Also Uninstall/Enable/Disable per App</li>
</ul>
<h2 id="uninstall">Uninstall&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#uninstall"></i></a> </h2>
<p>A System Admin can uninstall an app using the <code>/uninstall</code> slash command. On uninstallation appropriate bot and an OAuth app are deleted, <code>OnUninstall</code> call is sent to the app as well. Worth mentioning that the current implementation is not deleting the user data.</p>
<h2 id="upgradedowngrade-consideration">Upgrade/downgrade consideration&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#upgradedowngrade-consideration"></i></a> </h2>
<h2 id="appsctl">appsctl&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#appsctl"></i></a> </h2>
<h1 id="interactivity">Interactivity&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#interactivity"></i></a> </h1>
<p>This page shows the payloads for browser request/responses, and App server request/responses.</p>
<h2 id="get-bindings">Get Bindings&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#get-bindings"></i></a> </h2>
<details><summary>Client Bindings Request</summary>
<p><code>GET</code> /plugins/com.mattermost.apps/api/v1/bindings?user_id=ws4o4macctyn5ko8uhkkxmgfur&amp;channel_id=qphz13bzbf8c7j778tdnaw3huc&amp;scope=webapp</p>
</details>
<details><summary>MM Bindings Request</summary>
POST /plugins/com.mattermost.apps/example/hello/bindings
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/bindings&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;context&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;app_id&#34;</span>: <span style="color:#c30">&#34;helloworld&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;bot_user_id&#34;</span>: <span style="color:#c30">&#34;i4wzxbk1hbbufq8rnecso96oxr&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;acting_user_id&#34;</span>: <span style="color:#c30">&#34;81bqom3kjjbo7bcjcnzs6dc8uh&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;user_id&#34;</span>: <span style="color:#c30">&#34;81bqom3kjjbo7bcjcnzs6dc8uh&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;team_id&#34;</span>: <span style="color:#c30">&#34;&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;channel_id&#34;</span>: <span style="color:#c30">&#34;ytqokpzzcinszf7ywrbdfitusw&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;mattermost_site_url&#34;</span>: <span style="color:#c30">&#34;http://localhost:8065&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;user_agent&#34;</span>: <span style="color:#c30">&#34;webapp&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;bot_access_token&#34;</span>: <span style="color:#c30">&#34;gcn6r3ac178zbxwiw5pc38e8zc&#34;</span>
    }
}
</code></pre></div></details>
<details><summary>App Binding Response</summary>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;ok&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;data&#34;</span>: [
        {
            <span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;/channel_header&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;bindings&#34;</span>: [
                {
                    <span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;send-button&#34;</span>,
                    <span style="color:#309;font-weight:bold">&#34;icon&#34;</span>: <span style="color:#c30">&#34;http://localhost:8080/static/icon.png&#34;</span>,
                    <span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;send hello message&#34;</span>,
                    <span style="color:#309;font-weight:bold">&#34;call&#34;</span>: {
                        <span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/send-modal&#34;</span>
                    }
                }
            ]
        },
        {
            <span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;/post_menu&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;bindings&#34;</span>: [
                {
                    <span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;send-button&#34;</span>,
                    <span style="color:#309;font-weight:bold">&#34;icon&#34;</span>: <span style="color:#c30">&#34;http://localhost:8080/static/icon.png&#34;</span>,
                    <span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;send hello message&#34;</span>,
                    <span style="color:#309;font-weight:bold">&#34;call&#34;</span>: {
                        <span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/send&#34;</span>,
                        <span style="color:#309;font-weight:bold">&#34;expand&#34;</span>: {
                            <span style="color:#309;font-weight:bold">&#34;post&#34;</span>: <span style="color:#c30">&#34;all&#34;</span>
                        }
                    }
                }
            ]
        },
        {
            <span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;/command&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;bindings&#34;</span>: [
                {
                    <span style="color:#309;font-weight:bold">&#34;icon&#34;</span>: <span style="color:#c30">&#34;http://localhost:8080/static/icon.png&#34;</span>,
                    <span style="color:#309;font-weight:bold">&#34;description&#34;</span>: <span style="color:#c30">&#34;Hello World app&#34;</span>,
                    <span style="color:#309;font-weight:bold">&#34;hint&#34;</span>: <span style="color:#c30">&#34;[send]&#34;</span>,
                    <span style="color:#309;font-weight:bold">&#34;bindings&#34;</span>: [
                        {
                            <span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;send&#34;</span>,
                            <span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;send&#34;</span>,
                            <span style="color:#309;font-weight:bold">&#34;call&#34;</span>: {
                                <span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/send-modal&#34;</span>
                            }
                        }
                    ]
                }
            ]
        }
    ]
}
</code></pre></div></details>
<h2 id="clicked-channel-header">Clicked Channel Header&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#clicked-channel-header"></i></a> </h2>
<details><summary>Client Submit Request</summary>
<p>POST /plugins/com.mattermost.apps/api/v1/call</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/send-modal/submit&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;context&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;app_id&#34;</span>: <span style="color:#c30">&#34;helloworld&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;send-button&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;channel_id&#34;</span>: <span style="color:#c30">&#34;ytqokpzzcinszf7ywrbdfitusw&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;team_id&#34;</span>: <span style="color:#c30">&#34;t35b8k7hginoujwn76tfatue5e&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;user_agent&#34;</span>: <span style="color:#c30">&#34;webapp&#34;</span>
    },
    <span style="color:#309;font-weight:bold">&#34;expand&#34;</span>: {}
}
</code></pre></div></details>
<details><summary>MM Submit Request</summary>
<p>POST /plugins/com.mattermost.apps/example/hello/send-modal/submit</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/send-modal/submit&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;expand&#34;</span>: {},
    <span style="color:#309;font-weight:bold">&#34;context&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;app_id&#34;</span>: <span style="color:#c30">&#34;helloworld&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;send-button&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;bot_user_id&#34;</span>: <span style="color:#c30">&#34;i4wzxbk1hbbufq8rnecso96oxr&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;acting_user_id&#34;</span>: <span style="color:#c30">&#34;81bqom3kjjbo7bcjcnzs6dc8uh&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;team_id&#34;</span>: <span style="color:#c30">&#34;t35b8k7hginoujwn76tfatue5e&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;channel_id&#34;</span>: <span style="color:#c30">&#34;ytqokpzzcinszf7ywrbdfitusw&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;mattermost_site_url&#34;</span>: <span style="color:#c30">&#34;http://localhost:8065&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;user_agent&#34;</span>: <span style="color:#c30">&#34;webapp&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;bot_access_token&#34;</span>: <span style="color:#c30">&#34;sqo3nwt377ys3co78jzye3cwmw&#34;</span>
    }
}
</code></pre></div></details>
<details><summary>App Form Response</summary>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;form&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;form&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;title&#34;</span>: <span style="color:#c30">&#34;Hello, world!&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;icon&#34;</span>: <span style="color:#c30">&#34;http://localhost:8080/static/icon.png&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;fields&#34;</span>: [
            {
                <span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;text&#34;</span>,
                <span style="color:#309;font-weight:bold">&#34;name&#34;</span>: <span style="color:#c30">&#34;message&#34;</span>,
                <span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;message&#34;</span>
            },
            {
                <span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;user&#34;</span>,
                <span style="color:#309;font-weight:bold">&#34;name&#34;</span>: <span style="color:#c30">&#34;user&#34;</span>,
                <span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;user&#34;</span>,
                <span style="color:#309;font-weight:bold">&#34;refresh&#34;</span>: <span style="color:#069;font-weight:bold">true</span>
            },
            {
                <span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;dynamic_select&#34;</span>,
                <span style="color:#309;font-weight:bold">&#34;name&#34;</span>: <span style="color:#c30">&#34;lookup&#34;</span>,
                <span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;lookup&#34;</span>
            }
        ],
        <span style="color:#309;font-weight:bold">&#34;call&#34;</span>: {
            <span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/send&#34;</span>
        }
    }
}
</code></pre></div></details>
<h2 id="selected-user-in-modal">Selected user in modal&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#selected-user-in-modal"></i></a> </h2>
<p><code>refresh: true</code> is used to tell the client to notify the server when a value is selected from this field</p>
<details><summary>Client Form Request</summary>
<p>POST /plugins/com.mattermost.apps/api/v1/call</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/send/form&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;expand&#34;</span>: {},
    <span style="color:#309;font-weight:bold">&#34;values&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;message&#34;</span>: <span style="color:#c30">&#34;This is great!&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;user&#34;</span>: {
            <span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;mickmister&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;value&#34;</span>: <span style="color:#c30">&#34;81bqom3kjjbo7bcjcnzs6dc8uh&#34;</span>
        }
    },
    <span style="color:#309;font-weight:bold">&#34;context&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;app_id&#34;</span>: <span style="color:#c30">&#34;helloworld&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;/command&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;bot_user_id&#34;</span>: <span style="color:#c30">&#34;i4wzxbk1hbbufq8rnecso96oxr&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;acting_user_id&#34;</span>: <span style="color:#c30">&#34;81bqom3kjjbo7bcjcnzs6dc8uh&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;team_id&#34;</span>: <span style="color:#c30">&#34;t35b8k7hginoujwn76tfatue5e&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;channel_id&#34;</span>: <span style="color:#c30">&#34;f45uwdqsejdnzjtyy19ysqr44w&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;mattermost_site_url&#34;</span>: <span style="color:#c30">&#34;http://localhost:8065&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;user_agent&#34;</span>: <span style="color:#c30">&#34;webapp&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;bot_access_token&#34;</span>: <span style="color:#c30">&#34;gcn6r3ac178zbxwiw5pc38e8zc&#34;</span>
    },
    <span style="color:#309;font-weight:bold">&#34;raw_command&#34;</span>: <span style="color:#c30">&#34;/helloworld send&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;selected_field&#34;</span>: <span style="color:#c30">&#34;user&#34;</span>
}
</code></pre></div></details>
<details><summary>MM Form Request</summary>
<p>POST /plugins/com.mattermost.apps/hello/send/form</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/send/form&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;expand&#34;</span>: {},
    <span style="color:#309;font-weight:bold">&#34;values&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;message&#34;</span>: <span style="color:#c30">&#34;This is great!&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;user&#34;</span>: {
            <span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;mickmister&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;value&#34;</span>: <span style="color:#c30">&#34;81bqom3kjjbo7bcjcnzs6dc8uh&#34;</span>
        }
    },
    <span style="color:#309;font-weight:bold">&#34;context&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;app_id&#34;</span>: <span style="color:#c30">&#34;helloworld&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;/command&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;bot_user_id&#34;</span>: <span style="color:#c30">&#34;i4wzxbk1hbbufq8rnecso96oxr&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;acting_user_id&#34;</span>: <span style="color:#c30">&#34;81bqom3kjjbo7bcjcnzs6dc8uh&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;team_id&#34;</span>: <span style="color:#c30">&#34;t35b8k7hginoujwn76tfatue5e&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;channel_id&#34;</span>: <span style="color:#c30">&#34;f45uwdqsejdnzjtyy19ysqr44w&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;mattermost_site_url&#34;</span>: <span style="color:#c30">&#34;http://localhost:8065&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;user_agent&#34;</span>: <span style="color:#c30">&#34;webapp&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;bot_access_token&#34;</span>: <span style="color:#c30">&#34;gcn6r3ac178zbxwiw5pc38e8zc&#34;</span>
    },
    <span style="color:#309;font-weight:bold">&#34;raw_command&#34;</span>: <span style="color:#c30">&#34;/helloworld send&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;selected_field&#34;</span>: <span style="color:#c30">&#34;user&#34;</span>
}
</code></pre></div></details>
<details><summary>App Form Response</summary>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;form&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;form&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;title&#34;</span>: <span style="color:#c30">&#34;Hello, world!&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;icon&#34;</span>: <span style="color:#c30">&#34;http://localhost:8080/static/icon.png&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;fields&#34;</span>: [
            {
				<span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;text&#34;</span>,
				<span style="color:#309;font-weight:bold">&#34;name&#34;</span>: <span style="color:#c30">&#34;message&#34;</span>,
				<span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;message&#34;</span>
			},
			{
				<span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;user&#34;</span>,
				<span style="color:#309;font-weight:bold">&#34;name&#34;</span>: <span style="color:#c30">&#34;user&#34;</span>,
				<span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;user&#34;</span>,
				<span style="color:#309;font-weight:bold">&#34;refresh&#34;</span>: <span style="color:#069;font-weight:bold">true</span>
			},
			{
				<span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;dynamic_select&#34;</span>,
				<span style="color:#309;font-weight:bold">&#34;name&#34;</span>: <span style="color:#c30">&#34;lookup&#34;</span>,
				<span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;lookup&#34;</span>
			}
        ],
        <span style="color:#309;font-weight:bold">&#34;call&#34;</span>: {
            <span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/send&#34;</span>
        }
    }
}
</code></pre></div></details>
<h2 id="dynamic-lookup">Dynamic Lookup&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#dynamic-lookup"></i></a> </h2>
<details><summary>Client Lookup Request</summary>
<p>POST /plugins/com.mattermost.apps/api/v1/call</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/send/lookup&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;context&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;app_id&#34;</span>: <span style="color:#c30">&#34;helloworld&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;/command&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;root_id&#34;</span>: <span style="color:#c30">&#34;&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;channel_id&#34;</span>: <span style="color:#c30">&#34;f45uwdqsejdnzjtyy19ysqr44w&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;team_id&#34;</span>: <span style="color:#c30">&#34;t35b8k7hginoujwn76tfatue5e&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;user_agent&#34;</span>: <span style="color:#c30">&#34;webapp&#34;</span>
    },
    <span style="color:#309;font-weight:bold">&#34;values&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;message&#34;</span>: <span style="color:#069;font-weight:bold">null</span>,
        <span style="color:#309;font-weight:bold">&#34;user&#34;</span>: <span style="color:#069;font-weight:bold">null</span>,
        <span style="color:#309;font-weight:bold">&#34;lookup&#34;</span>: {
            <span style="color:#309;font-weight:bold">&#34;icon_data&#34;</span>: <span style="color:#c30">&#34;&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;Option 1&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;value&#34;</span>: <span style="color:#c30">&#34;option1&#34;</span>
        }
    },
    <span style="color:#309;font-weight:bold">&#34;expand&#34;</span>: {},
    <span style="color:#309;font-weight:bold">&#34;raw_command&#34;</span>: <span style="color:#c30">&#34;/helloworld send&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;query&#34;</span>: <span style="color:#c30">&#34;o&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;selected_field&#34;</span>: <span style="color:#c30">&#34;lookup&#34;</span>
}
</code></pre></div></details>
<details><summary>MM Lookup Request</summary>
<p>POST /plugins/com.mattermost.apps/example/hello/send/lookup</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/send/lookup&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;expand&#34;</span>: {},
    <span style="color:#309;font-weight:bold">&#34;values&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;lookup&#34;</span>: {
            <span style="color:#309;font-weight:bold">&#34;icon_data&#34;</span>: <span style="color:#c30">&#34;&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;Option 1&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;value&#34;</span>: <span style="color:#c30">&#34;option1&#34;</span>
        },
        <span style="color:#309;font-weight:bold">&#34;message&#34;</span>: <span style="color:#069;font-weight:bold">null</span>,
        <span style="color:#309;font-weight:bold">&#34;user&#34;</span>: <span style="color:#069;font-weight:bold">null</span>
    },
    <span style="color:#309;font-weight:bold">&#34;context&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;app_id&#34;</span>: <span style="color:#c30">&#34;helloworld&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;/command&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;bot_user_id&#34;</span>: <span style="color:#c30">&#34;i4wzxbk1hbbufq8rnecso96oxr&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;acting_user_id&#34;</span>: <span style="color:#c30">&#34;81bqom3kjjbo7bcjcnzs6dc8uh&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;team_id&#34;</span>: <span style="color:#c30">&#34;t35b8k7hginoujwn76tfatue5e&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;channel_id&#34;</span>: <span style="color:#c30">&#34;f45uwdqsejdnzjtyy19ysqr44w&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;mattermost_site_url&#34;</span>: <span style="color:#c30">&#34;http://localhost:8065&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;user_agent&#34;</span>: <span style="color:#c30">&#34;webapp&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;bot_access_token&#34;</span>: <span style="color:#c30">&#34;gcn6r3ac178zbxwiw5pc38e8zc&#34;</span>
    },
    <span style="color:#309;font-weight:bold">&#34;raw_command&#34;</span>: <span style="color:#c30">&#34;/helloworld send&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;selected_field&#34;</span>: <span style="color:#c30">&#34;lookup&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;query&#34;</span>: <span style="color:#c30">&#34;o&#34;</span>
}
</code></pre></div></details>
<details><summary>App Lookup Response</summary>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;ok&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;data&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;items&#34;</span>: [
            {
                <span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;Option 1&#34;</span>,
                <span style="color:#309;font-weight:bold">&#34;value&#34;</span>: <span style="color:#c30">&#34;option1&#34;</span>,
                <span style="color:#309;font-weight:bold">&#34;icon_data&#34;</span>: <span style="color:#c30">&#34;&#34;</span>
            },
            {
                <span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;Option 2&#34;</span>,
                <span style="color:#309;font-weight:bold">&#34;value&#34;</span>: <span style="color:#c30">&#34;option2&#34;</span>,
                <span style="color:#309;font-weight:bold">&#34;icon_data&#34;</span>: <span style="color:#c30">&#34;&#34;</span>
            }
        ]
    }
}
</code></pre></div></details>
<h2 id="submitted-modal">Submitted Modal&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#submitted-modal"></i></a> </h2>
<details><summary>Client Submit Request</summary>
<p>POST /plugins/com.mattermost.apps/api/v1/call</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/send/submit&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;context&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;app_id&#34;</span>: <span style="color:#c30">&#34;helloworld&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;/command&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;root_id&#34;</span>: <span style="color:#c30">&#34;&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;channel_id&#34;</span>: <span style="color:#c30">&#34;qxb1zg7eqjn1ixwuwhwtgmt55o&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;team_id&#34;</span>: <span style="color:#c30">&#34;t35b8k7hginoujwn76tfatue5e&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;user_agent&#34;</span>: <span style="color:#c30">&#34;webapp&#34;</span>
    },
    <span style="color:#309;font-weight:bold">&#34;values&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;message&#34;</span>: <span style="color:#c30">&#34;the message&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;user&#34;</span>: {
            <span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;mickmister&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;value&#34;</span>: <span style="color:#c30">&#34;81bqom3kjjbo7bcjcnzs6dc8uh&#34;</span>
        },
        <span style="color:#309;font-weight:bold">&#34;lookup&#34;</span>: {
            <span style="color:#309;font-weight:bold">&#34;icon_data&#34;</span>: <span style="color:#c30">&#34;&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;Option 1&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;value&#34;</span>: <span style="color:#c30">&#34;option1&#34;</span>
        }
    },
    <span style="color:#309;font-weight:bold">&#34;expand&#34;</span>: {},
    <span style="color:#309;font-weight:bold">&#34;raw_command&#34;</span>: <span style="color:#c30">&#34;/helloworld send&#34;</span>
}
</code></pre></div></details>
<details><summary>MM Submit Request</summary>
<p>POST /plugins/com.mattermost.apps/example/hello/send/submit</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/send/submit&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;expand&#34;</span>: {},
    <span style="color:#309;font-weight:bold">&#34;values&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;lookup&#34;</span>: {
            <span style="color:#309;font-weight:bold">&#34;icon_data&#34;</span>: <span style="color:#c30">&#34;&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;Option 1&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;value&#34;</span>: <span style="color:#c30">&#34;option1&#34;</span>
        },
        <span style="color:#309;font-weight:bold">&#34;message&#34;</span>: <span style="color:#c30">&#34;the message&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;user&#34;</span>: {
            <span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;mickmister&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;value&#34;</span>: <span style="color:#c30">&#34;81bqom3kjjbo7bcjcnzs6dc8uh&#34;</span>
        }
    },
    <span style="color:#309;font-weight:bold">&#34;context&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;app_id&#34;</span>: <span style="color:#c30">&#34;helloworld&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;/command&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;bot_user_id&#34;</span>: <span style="color:#c30">&#34;i4wzxbk1hbbufq8rnecso96oxr&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;acting_user_id&#34;</span>: <span style="color:#c30">&#34;81bqom3kjjbo7bcjcnzs6dc8uh&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;team_id&#34;</span>: <span style="color:#c30">&#34;t35b8k7hginoujwn76tfatue5e&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;channel_id&#34;</span>: <span style="color:#c30">&#34;qxb1zg7eqjn1ixwuwhwtgmt55o&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;mattermost_site_url&#34;</span>: <span style="color:#c30">&#34;http://localhost:8065&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;user_agent&#34;</span>: <span style="color:#c30">&#34;webapp&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;bot_access_token&#34;</span>: <span style="color:#c30">&#34;gcn6r3ac178zbxwiw5pc38e8zc&#34;</span>
    },
    <span style="color:#309;font-weight:bold">&#34;raw_command&#34;</span>: <span style="color:#c30">&#34;/helloworld send&#34;</span>
}
</code></pre></div></details>
<details><summary>App Submit Response</summary>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;type&#34;</span>:<span style="color:#c30">&#34;ok&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;markdown&#34;</span>:<span style="color:#c30">&#34;Sent survey to mickmister.&#34;</span>
}
</code></pre></div></details>
<h2 id="returning-a-single-error">Returning a single error&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#returning-a-single-error"></i></a> </h2>
<details><summary>Main Error Response</summary>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;type&#34;</span>:<span style="color:#c30">&#34;error&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;error&#34;</span>:<span style="color:#c30">&#34;This is the error.&#34;</span>
}
</code></pre></div></details>
<h2 id="returning-errors-for-specific-fields">Returning errors for specific fields&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#returning-errors-for-specific-fields"></i></a> </h2>
<details><summary>Field-specific Error Response</summary>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;type&#34;</span>:<span style="color:#c30">&#34;error&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;data&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;errors&#34;</span>:{
            <span style="color:#309;font-weight:bold">&#34;somefield&#34;</span>: <span style="color:#c30">&#34;This field seems to have an invalid value.&#34;</span>
        }
    }
}
</code></pre></div></details>
<h2 id="returning-a-main-error-and-errors-for-specific-fields-includes-picture">Returning a main error and errors for specific fields (includes picture)&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#returning-a-main-error-and-errors-for-specific-fields-includes-picture"></i></a> </h2>
<details><summary>Main Error and Field-specific Error Response</summary>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;type&#34;</span>:<span style="color:#c30">&#34;error&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;error&#34;</span>:<span style="color:#c30">&#34;This is the error.&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;data&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;errors&#34;</span>:{
            <span style="color:#309;font-weight:bold">&#34;somefield&#34;</span>: <span style="color:#c30">&#34;This field seems to have an invalid value.&#34;</span>
        }
    }
}
</code></pre></div><p><img src="https://user-images.githubusercontent.com/6913320/112268885-0722f000-8c4e-11eb-9ad1-2874e89049cd.png" alt="modal-errors.png"></p>
</details>
<h1 id="post-menu-example">Post Menu Example&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#post-menu-example"></i></a> </h1>
<p>In this example, the bindings specify to expand the post the user clicks on:</p>
<p><img src="https://user-images.githubusercontent.com/6913320/109165112-2e6ac800-7749-11eb-8d83-d495258f3f1e.png" alt="binding-form-diagram.png"></p>
<details><summary>Diagram Source</summary>
<p><a href="https://sequencediagram.org">https://sequencediagram.org</a></p>
<pre><code>title Bindings + Form Example

Client-&gt;MM: Visit ChannelA, fetch bindings (Client Bindings Request)
MM-&gt;App:Fetch bindings with call (MM Bindings Request)
App-&gt;3rd Party Integration:Check user status
3rd Party Integration-&gt;App:Return user status
App-&gt;MM:Return bindings (App Bindings Response)
MM-&gt;Client:Return bindings, render App's post menu item
Client-&gt;MM:Clicked post menu item. Perform submit call (Client Submit Request)
MM-&gt;App:Perform submit call (MM Submit Request)
App-&gt;3rd Party Integration:Do something useful
3rd Party Integration-&gt;App:Return something useful
App-&gt;MM:Return new modal form (App Form Response)
MM-&gt;Client:Return modal form, open modal
</code></pre></details>
<h2 id="fetch-bindings">Fetch bindings&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#fetch-bindings"></i></a> </h2>
<details><summary>Client Bindings Request</summary>
<p>GET /plugins/com.mattermost.apps/api/v1/bindings?channel_id=ei748ohj3ig4ijofs5tr47wozh&amp;scope=webapp</p>
</details>
<details><summary>MM Bindings Request</summary>
POST /plugins/com.mattermost.apps/example/hello/bindings
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/bindings&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;context&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;app_id&#34;</span>: <span style="color:#c30">&#34;helloworld&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;bot_user_id&#34;</span>: <span style="color:#c30">&#34;i4wzxbk1hbbufq8rnecso96oxr&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;acting_user_id&#34;</span>: <span style="color:#c30">&#34;81bqom3kjjbo7bcjcnzs6dc8uh&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;user_id&#34;</span>: <span style="color:#c30">&#34;81bqom3kjjbo7bcjcnzs6dc8uh&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;team_id&#34;</span>: <span style="color:#c30">&#34;&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;channel_id&#34;</span>: <span style="color:#c30">&#34;ytqokpzzcinszf7ywrbdfitusw&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;mattermost_site_url&#34;</span>: <span style="color:#c30">&#34;http://localhost:8065&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;user_agent&#34;</span>: <span style="color:#c30">&#34;webapp&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;bot_access_token&#34;</span>: <span style="color:#c30">&#34;gcn6r3ac178zbxwiw5pc38e8zc&#34;</span>
    }
}
</code></pre></div></details>
<details><summary>App Bindings Response</summary>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;ok&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;data&#34;</span>: [
        {
            <span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;/post_menu&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;bindings&#34;</span>: [
                {
                    <span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;send-button&#34;</span>,
                    <span style="color:#309;font-weight:bold">&#34;icon&#34;</span>: <span style="color:#c30">&#34;http://localhost:8080/static/icon.png&#34;</span>,
                    <span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;send hello message&#34;</span>,
                    <span style="color:#309;font-weight:bold">&#34;call&#34;</span>: {
                        <span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/send-modal&#34;</span>,
                        <span style="color:#309;font-weight:bold">&#34;expand&#34;</span>: {
                            <span style="color:#309;font-weight:bold">&#34;post&#34;</span>: <span style="color:#c30">&#34;all&#34;</span>
                        }
                    }
                }
            ]
        }
    ]
}
</code></pre></div></details>
<h2 id="clicked-post-menu-item">Clicked post menu item&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#clicked-post-menu-item"></i></a> </h2>
<details><summary>Client Submit Request</summary>
<p>POST /plugins/com.mattermost.apps/api/v1/call</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/send-modal/submit&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;expand&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;post&#34;</span>: <span style="color:#c30">&#34;all&#34;</span>
    },
    <span style="color:#309;font-weight:bold">&#34;context&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;app_id&#34;</span>: <span style="color:#c30">&#34;helloworld&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;send-button&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;channel_id&#34;</span>: <span style="color:#c30">&#34;ytqokpzzcinszf7ywrbdfitusw&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;team_id&#34;</span>: <span style="color:#c30">&#34;t35b8k7hginoujwn76tfatue5e&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;post_id&#34;</span>: <span style="color:#c30">&#34;jysnx7byebf49yxx1uynefajiy&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;root_id&#34;</span>: <span style="color:#c30">&#34;&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;user_agent&#34;</span>: <span style="color:#c30">&#34;webapp&#34;</span>
    }
}
</code></pre></div></details>
<details><summary>MM Submit Request</summary>
<p>POST /plugins/com.mattermost.apps/example/hello/send/submit</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/send-modal/submit&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;expand&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;post&#34;</span>: <span style="color:#c30">&#34;all&#34;</span>
    },
    <span style="color:#309;font-weight:bold">&#34;context&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;app_id&#34;</span>: <span style="color:#c30">&#34;helloworld&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;send-button&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;bot_user_id&#34;</span>: <span style="color:#c30">&#34;i4wzxbk1hbbufq8rnecso96oxr&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;acting_user_id&#34;</span>: <span style="color:#c30">&#34;81bqom3kjjbo7bcjcnzs6dc8uh&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;team_id&#34;</span>: <span style="color:#c30">&#34;t35b8k7hginoujwn76tfatue5e&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;channel_id&#34;</span>: <span style="color:#c30">&#34;ytqokpzzcinszf7ywrbdfitusw&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;post_id&#34;</span>: <span style="color:#c30">&#34;jysnx7byebf49yxx1uynefajiy&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;mattermost_site_url&#34;</span>: <span style="color:#c30">&#34;http://localhost:8065&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;user_agent&#34;</span>: <span style="color:#c30">&#34;webapp&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;bot_access_token&#34;</span>: <span style="color:#c30">&#34;sqo3nwt377ys3co78jzye3cwmw&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;post&#34;</span>: {
            <span style="color:#309;font-weight:bold">&#34;id&#34;</span>: <span style="color:#c30">&#34;jysnx7byebf49yxx1uynefajiy&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;create_at&#34;</span>: <span style="color:#f60">1616447014367</span>,
            <span style="color:#309;font-weight:bold">&#34;update_at&#34;</span>: <span style="color:#f60">1616447014367</span>,
            <span style="color:#309;font-weight:bold">&#34;edit_at&#34;</span>: <span style="color:#f60">0</span>,
            <span style="color:#309;font-weight:bold">&#34;delete_at&#34;</span>: <span style="color:#f60">0</span>,
            <span style="color:#309;font-weight:bold">&#34;is_pinned&#34;</span>: <span style="color:#069;font-weight:bold">false</span>,
            <span style="color:#309;font-weight:bold">&#34;user_id&#34;</span>: <span style="color:#c30">&#34;81bqom3kjjbo7bcjcnzs6dc8uh&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;channel_id&#34;</span>: <span style="color:#c30">&#34;ytqokpzzcinszf7ywrbdfitusw&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;root_id&#34;</span>: <span style="color:#c30">&#34;&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;parent_id&#34;</span>: <span style="color:#c30">&#34;&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;original_id&#34;</span>: <span style="color:#c30">&#34;&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;message&#34;</span>: <span style="color:#c30">&#34;Hey I have a question&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;props&#34;</span>: {},
            <span style="color:#309;font-weight:bold">&#34;hashtags&#34;</span>: <span style="color:#c30">&#34;&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;pending_post_id&#34;</span>: <span style="color:#c30">&#34;&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;reply_count&#34;</span>: <span style="color:#f60">0</span>,
            <span style="color:#309;font-weight:bold">&#34;last_reply_at&#34;</span>: <span style="color:#f60">0</span>,
            <span style="color:#309;font-weight:bold">&#34;participants&#34;</span>: <span style="color:#069;font-weight:bold">null</span>
        }
    }
}
</code></pre></div></details>
<details><summary>App Form Response</summary>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;form&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;form&#34;</span>: {
        <span style="color:#309;font-weight:bold">&#34;title&#34;</span>: <span style="color:#c30">&#34;Hello, world!&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;icon&#34;</span>: <span style="color:#c30">&#34;http://localhost:8080/static/icon.png&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;fields&#34;</span>: [
            {
                <span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;text&#34;</span>,
                <span style="color:#309;font-weight:bold">&#34;name&#34;</span>: <span style="color:#c30">&#34;message&#34;</span>,
                <span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;message&#34;</span>
            },
            {
                <span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;user&#34;</span>,
                <span style="color:#309;font-weight:bold">&#34;name&#34;</span>: <span style="color:#c30">&#34;user&#34;</span>,
                <span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;user&#34;</span>,
                <span style="color:#309;font-weight:bold">&#34;refresh&#34;</span>: <span style="color:#069;font-weight:bold">true</span>
            },
            {
                <span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;dynamic_select&#34;</span>,
                <span style="color:#309;font-weight:bold">&#34;name&#34;</span>: <span style="color:#c30">&#34;lookup&#34;</span>,
                <span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;lookup&#34;</span>
            }
        ],
        <span style="color:#309;font-weight:bold">&#34;call&#34;</span>: {
            <span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/send&#34;</span>
        }
    }
}
</code></pre></div></details>
<h1 id="using-mattermost-apis">Using Mattermost APIs&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#using-mattermost-apis"></i></a> </h1>
<h2 id="authentication-and-permissions">Authentication and Permissions&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#authentication-and-permissions"></i></a> </h2>
<p><strong>OAuth2 is not yet implemented, for now session tokens are passed in as ActingUserAccessToken</strong></p>
<p>An app can use the Mattermost server REST API, as well as new &ldquo;App Services&rdquo; APIs offered specifically to Mattermost Apps. An app authenticates its requests to Mattermost by providing access tokens, usually Bot Access token, or user&rsquo;s OAuth2 access token. Each call request sent to the app includes Mattermost site URL, and optionally one or more access tokens the app can use.</p>
<p>What tokens the app gets, and what access the app may have with them depends on the combination of App granted permissions, the tokens requested in call.Expand, and their respective access rights.</p>
<ul>
<li>godoc: <a href="https://pkg.go.dev/github.com/mattermost/mattermost-plugin-apps/apps#Permission">Permission</a> -
<a href="http://localhost:6060/pkg/github.com/mattermost/mattermost-plugin-apps/apps#Permission">local</a> -
describes the available permissions.</li>
<li>tickets:
<ul>
<li><a href="">MM-??</a></li>
</ul>
</li>
</ul>
<h2 id="apps-subscriptions-api">Apps Subscriptions API&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#apps-subscriptions-api"></i></a> </h2>
<ul>
<li>godoc: <a href="https://pkg.go.dev/github.com/mattermost/mattermost-plugin-apps/apps#Subscription">Subscription</a> -
<a href="http://localhost:6060/pkg/github.com/mattermost/mattermost-plugin-apps/apps#Subscription">local</a> -
describes the Subscription request.</li>
<li>godoc: <a href="https://pkg.go.dev/github.com/mattermost/mattermost-plugin-apps/apps/mmclient/#Client.Subscribe">Go Client</a> - <a href="http://localhost:6060/pkg/github.com/mattermost/mattermost-plugin-apps/apps/mmclient/#Client.Subscribe">local</a> - The methods to post Subscribe/Unsubscribe requests.</li>
</ul>
<p>Subscribe and Unsubscribe APIs are invocable with Bot, User, or Admin tokens, however they may fail if the token lacks access to the resource. For instance, the app&rsquo;s Bot account needs to be invited to the channel before the app can subscribe to the events in the channel as the Bot.</p>
<h2 id="apps-kv-store-api">Apps KV Store API&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#apps-kv-store-api"></i></a> </h2>
<ul>
<li>godoc: <a href="https://pkg.go.dev/github.com/mattermost/mattermost-plugin-apps/apps/mmclient/#Client.KVDelete">Go Client</a> - <a href="http://localhost:6060/pkg/github.com/mattermost/mattermost-plugin-apps/apps/mmclient/#Client.KVDelete">local</a> - The methods for KV Get/Set/Delete requests.</li>
</ul>
<p>The KV APIs require the use of the Bot Account Token, and will fail if a user token is provided.</p>
<h2 id="mattermost-rest-api">Mattermost REST API&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#mattermost-rest-api"></i></a> </h2>
<ul>
<li>godoc: <a href="https://pkg.go.dev/github.com/mattermost/mattermost-plugin-apps/apps/mmclient/#Client">Go Client</a> - <a href="http://localhost:6060/pkg/github.com/mattermost/mattermost-plugin-apps/apps/mmclient/#Client">local</a> - mmclient.Client includes the *model.Client4 Mattermost REST API client, pre-initialized with the auth token.</li>
</ul>
<h1 id="using-3rd-party-apis">Using 3rd party APIs&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#using-3rd-party-apis"></i></a> </h1>
<p>Mattermost Apps framework provides services for using remote (3rd party) OAuth2
HTTP APIs, and receiving authenticated webhook notifications from remote
systems. There are 2 examples here to illustrate the <a href="#hello-oauth2">OAuth2</a> and
<a href="#hello-webhooks">webhook</a> support.</p>
<h2 id="hello-oauth2">Hello OAuth2!&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#hello-oauth2"></i></a> </h2>
<p>Here is an example of an HTTP App (<a href="https://developers.mattermost.com/examples/go/hello-oauth2">source</a>),
written in Go and runnable on http://localhost:8080.</p>
<ul>
<li>It contains a <code>manifest.json</code>, declares itself an HTTP application, requests
permissions and binds itself to locations in the Mattermost UI.</li>
<li>In its <code>bindings</code> function it declares 3 commands: <code>configure</code>, <code>connect</code>, and
<code>send</code>.</li>
<li>Its <code>send</code> function mentions the user by their Google name, and lists their
Google Calendars.</li>
</ul>
<p>To install &ldquo;Hello, OAuth2&rdquo; on a locally-running instance of Mattermost follow
these steps (go 1.16 is required):</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#366">cd</span> .../mattermost-plugin-apps/examples/go/hello-oauth2
go run . 
</code></pre></div><p>In Mattermost desktop app run:</p>
<pre><code>/apps debug-add-manifest --url http://localhost:8080/manifest.json
/apps install --app-id hello-oauth2
</code></pre><p>You need to configure your <a href="https://console.cloud.google.com/apis/credentials">Google API
Credentials</a> for the App. Use
<code>{MattermostSiteURL}/com.mattermost.apps/apps/hello-oauth2/oauth2/remote/complete</code>
for the <code>Authorized redirect URIs</code> field. After configuring the credentials, in Mattermost desktop app run:</p>
<pre><code>/hello-oauth2 configure --client-id {ClientID} --client-secret {ClientSecret}
</code></pre><p>Now, you can connect your account to Google with <code>/hello-oauth2 connect</code> command, and then try <code>/hello-oauth2 send</code>.</p>
<h3 id="manifest-1">Manifest&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#manifest-1"></i></a> </h3>
<p>Hello OAuth2! is an HTTP App, it requests the <em>permissions</em> to act as an Admin to change the App&rsquo;s OAuth2 config, as a User to connect and send. It binds itself to /commands.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
	<span style="color:#309;font-weight:bold">&#34;app_id&#34;</span>: <span style="color:#c30">&#34;hello-oauth2&#34;</span>,
	<span style="color:#309;font-weight:bold">&#34;version&#34;</span>:<span style="color:#c30">&#34;demo&#34;</span>,
	<span style="color:#309;font-weight:bold">&#34;display_name&#34;</span>: <span style="color:#c30">&#34;Hello, OAuth2!&#34;</span>,
	<span style="color:#309;font-weight:bold">&#34;app_type&#34;</span>: <span style="color:#c30">&#34;http&#34;</span>,
	<span style="color:#309;font-weight:bold">&#34;root_url&#34;</span>: <span style="color:#c30">&#34;http://localhost:8080&#34;</span>,
	<span style="color:#309;font-weight:bold">&#34;homepage_url&#34;</span>: <span style="color:#c30">&#34;https://github.com/mattermost/mattermost-plugin-apps/examples/go/hello-oauth2&#34;</span>,
	<span style="color:#309;font-weight:bold">&#34;requested_permissions&#34;</span>: [
		<span style="color:#c30">&#34;act_as_admin&#34;</span>,
		<span style="color:#c30">&#34;act_as_user&#34;</span>,
		<span style="color:#c30">&#34;remote_oauth2&#34;</span>
	],
	<span style="color:#309;font-weight:bold">&#34;requested_locations&#34;</span>: [
		<span style="color:#c30">&#34;/command&#34;</span>
	]
}
</code></pre></div><h3 id="bindings-and-locations-2">Bindings and Locations&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#bindings-and-locations-2"></i></a> </h3>
<p>The Hello OAuth2! creates 3 commands: <code>/helloworld configure|connect|send</code>.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
	<span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;ok&#34;</span>,
	<span style="color:#309;font-weight:bold">&#34;data&#34;</span>: [
		{
			<span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;/command&#34;</span>,
			<span style="color:#309;font-weight:bold">&#34;bindings&#34;</span>: [
				{
					<span style="color:#309;font-weight:bold">&#34;icon&#34;</span>: <span style="color:#c30">&#34;http://localhost:8080/static/icon.png&#34;</span>,
					<span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;helloworld&#34;</span>,
					<span style="color:#309;font-weight:bold">&#34;description&#34;</span>: <span style="color:#c30">&#34;Hello remote (3rd party) OAuth2 App&#34;</span>,
					<span style="color:#309;font-weight:bold">&#34;hint&#34;</span>: <span style="color:#c30">&#34;[configure | connect | send]&#34;</span>,
					<span style="color:#309;font-weight:bold">&#34;bindings&#34;</span>: [
						{
							<span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;configure&#34;</span>,
							<span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;configure&#34;</span>,
							<span style="color:#309;font-weight:bold">&#34;call&#34;</span>: {
								<span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/configure&#34;</span>
							}
						},
						{
							<span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;connect&#34;</span>,
							<span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;connect&#34;</span>,
							<span style="color:#309;font-weight:bold">&#34;call&#34;</span>: {
								<span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/connect&#34;</span>
							}
						},
						{
							<span style="color:#309;font-weight:bold">&#34;location&#34;</span>: <span style="color:#c30">&#34;send&#34;</span>,
							<span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;send&#34;</span>,
							<span style="color:#309;font-weight:bold">&#34;call&#34;</span>: {
								<span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/send&#34;</span>
							}
						}
					]
				}
			]
		}
	]
}
</code></pre></div><h3 id="configuring-oauth2">Configuring OAuth2&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#configuring-oauth2"></i></a> </h3>
<p><code>/hello-oauth2 configure</code> sets up the Google OAuth2 credentials. It accepts 2
string flags, <code>--client-id</code> and <code>--client-secret</code>. Submit will require an Admin
token to affect the changes.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
	<span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;form&#34;</span>,
	<span style="color:#309;font-weight:bold">&#34;form&#34;</span>: {
		<span style="color:#309;font-weight:bold">&#34;title&#34;</span>: <span style="color:#c30">&#34;Configures Google OAuth2 App credentials&#34;</span>,
		<span style="color:#309;font-weight:bold">&#34;icon&#34;</span>: <span style="color:#c30">&#34;http://localhost:8080/static/icon.png&#34;</span>,
		<span style="color:#309;font-weight:bold">&#34;fields&#34;</span>: [
			{
				<span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;text&#34;</span>,
				<span style="color:#309;font-weight:bold">&#34;name&#34;</span>: <span style="color:#c30">&#34;client_id&#34;</span>,
				<span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;client-id&#34;</span>,
				<span style="color:#309;font-weight:bold">&#34;is_required&#34;</span>: <span style="color:#069;font-weight:bold">true</span>
			},
			{
				<span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;text&#34;</span>,
				<span style="color:#309;font-weight:bold">&#34;name&#34;</span>: <span style="color:#c30">&#34;client_secret&#34;</span>,
				<span style="color:#309;font-weight:bold">&#34;label&#34;</span>: <span style="color:#c30">&#34;client-secret&#34;</span>,
				<span style="color:#309;font-weight:bold">&#34;is_required&#34;</span>: <span style="color:#069;font-weight:bold">true</span>
			}
		],
		<span style="color:#309;font-weight:bold">&#34;call&#34;</span>: {
			<span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/configure&#34;</span>,
			<span style="color:#309;font-weight:bold">&#34;expand&#34;</span>: {
				<span style="color:#309;font-weight:bold">&#34;admin_access_token&#34;</span>: <span style="color:#c30">&#34;all&#34;</span>
			}
		}
	}
}
</code></pre></div><p>The command handler uses an admin-only <code>StoreOAuth2App</code> API to store the
credentials, and make them available to future Calls with
<code>expand.oauth2_app=&quot;all&quot;</code>.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#069;font-weight:bold">func</span> <span style="color:#c0f">configure</span>(w http.ResponseWriter, req <span style="color:#555">*</span>http.Request) {
	creq <span style="color:#555">:=</span> apps.CallRequest{}
	json.<span style="color:#c0f">NewDecoder</span>(req.Body).<span style="color:#c0f">Decode</span>(<span style="color:#555">&amp;</span>creq)
	clientID, _ <span style="color:#555">:=</span> creq.Values[<span style="color:#c30">&#34;client_id&#34;</span>].(<span style="color:#078;font-weight:bold">string</span>)
	clientSecret, _ <span style="color:#555">:=</span> creq.Values[<span style="color:#c30">&#34;client_secret&#34;</span>].(<span style="color:#078;font-weight:bold">string</span>)

	asAdmin <span style="color:#555">:=</span> mmclient.<span style="color:#c0f">AsAdmin</span>(creq.Context)
	asAdmin.<span style="color:#c0f">StoreOAuth2App</span>(creq.Context.AppID, clientID, clientSecret)

	json.<span style="color:#c0f">NewEncoder</span>(w).<span style="color:#c0f">Encode</span>(apps.CallResponse{
		Markdown: <span style="color:#c30">&#34;updated OAuth client credentials&#34;</span>,
	})
}
</code></pre></div><h3 id="connecting-as-a-user">Connecting as a User&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#connecting-as-a-user"></i></a> </h3>
<h4 id="connect-command">connect Command&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#connect-command"></i></a> </h4>
<p><code>/hello-oauth2 connect</code> formats and displays a link that starts the OAuth2 flow
with the remote system. The URL (provided to the app in the <code>Context</code>) is
handled by the apps framework. It will:</p>
<ul>
<li>create a 1-time secret (&ldquo;state&rdquo;)</li>
<li>invoke
oauth2Connect to generate the remote URL that starts the flow</li>
<li>redirect the user&rsquo;s browser there</li>
</ul>
<p>Note expand.oauth2_app=&quot;all&rdquo; in the form definition, it includes the App&rsquo;s
OAuth2 Mattermost-hosted callback URL in the request Context.</p>
<p>This command should soon be provided by the framework, see
<a href="https://mattermost.atlassian.net/browse/MM-34561">MM-34561</a>.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
	<span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;form&#34;</span>,
	<span style="color:#309;font-weight:bold">&#34;form&#34;</span>: {
		<span style="color:#309;font-weight:bold">&#34;title&#34;</span>: <span style="color:#c30">&#34;Connect to Google&#34;</span>,
		<span style="color:#309;font-weight:bold">&#34;icon&#34;</span>: <span style="color:#c30">&#34;http://localhost:8080/static/icon.png&#34;</span>,
		<span style="color:#309;font-weight:bold">&#34;call&#34;</span>: {
			<span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/connect&#34;</span>,
			<span style="color:#309;font-weight:bold">&#34;expand&#34;</span>: {
				<span style="color:#309;font-weight:bold">&#34;oauth2_app&#34;</span>: <span style="color:#c30">&#34;all&#34;</span>
			}
		}
	}
}
</code></pre></div><div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#069;font-weight:bold">func</span> <span style="color:#c0f">connect</span>(w http.ResponseWriter, req <span style="color:#555">*</span>http.Request) {
	creq <span style="color:#555">:=</span> apps.CallRequest{}
	json.<span style="color:#c0f">NewDecoder</span>(req.Body).<span style="color:#c0f">Decode</span>(<span style="color:#555">&amp;</span>creq)

	json.<span style="color:#c0f">NewEncoder</span>(w).<span style="color:#c0f">Encode</span>(apps.CallResponse{
		Markdown: md.<span style="color:#c0f">Markdownf</span>(<span style="color:#c30">&#34;[Connect](%s) to Google.&#34;</span>, creq.Context.OAuth2.ConnectURL),
	})
}
</code></pre></div><h4 id="oauth2-call-handlers">OAuth2 Call Handlers&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#oauth2-call-handlers"></i></a> </h4>
<p>To handle the OAuth2 &ldquo;connect&rdquo; flow, the app provides 2 Calls: <code>/oauth2/connect</code> that returns the URL to redirect the user to, and <code>/oauth2/complete</code> which gets invoked once the flow is finished, and the <code>state</code> parameter is verified.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">	<span style="color:#09f;font-style:italic">// Handle an OAuth2 connect URL request.
</span><span style="color:#09f;font-style:italic"></span>	http.<span style="color:#c0f">HandleFunc</span>(<span style="color:#c30">&#34;/oauth2/connect&#34;</span>, oauth2Connect)

	<span style="color:#09f;font-style:italic">// Handle a successful OAuth2 connection.
</span><span style="color:#09f;font-style:italic"></span>	http.<span style="color:#c0f">HandleFunc</span>(<span style="color:#c30">&#34;/oauth2/complete&#34;</span>, oauth2Complete)
</code></pre></div><p><strong>oauth2Connect</strong> extracts the necessary data from the request&rsquo;s Context and Values (&ldquo;state&rdquo;), and composes a Google OAuth2 initial URL.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#069;font-weight:bold">func</span> <span style="color:#c0f">oauth2Connect</span>(w http.ResponseWriter, req <span style="color:#555">*</span>http.Request) {
	creq <span style="color:#555">:=</span> apps.CallRequest{}
	json.<span style="color:#c0f">NewDecoder</span>(req.Body).<span style="color:#c0f">Decode</span>(<span style="color:#555">&amp;</span>creq)
	state, _ <span style="color:#555">:=</span> creq.Values[<span style="color:#c30">&#34;state&#34;</span>].(<span style="color:#078;font-weight:bold">string</span>)

	url <span style="color:#555">:=</span> <span style="color:#c0f">oauth2Config</span>(<span style="color:#555">&amp;</span>creq).<span style="color:#c0f">AuthCodeURL</span>(state, oauth2.AccessTypeOffline, oauth2.ApprovalForce)
	json.<span style="color:#c0f">NewEncoder</span>(w).<span style="color:#c0f">Encode</span>(apps.CallResponse{
		Type: apps.CallResponseTypeOK,
		Data: url,
	})
}
</code></pre></div><p><strong>oauth2Complete</strong> is called upon the successful completion (including the
validation of the &ldquo;state&rdquo;). It is responsible for creating an OAuth2 token, and
storing it in the Mattermost OAuth2 user store.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#069;font-weight:bold">func</span> <span style="color:#c0f">oauth2Complete</span>(w http.ResponseWriter, req <span style="color:#555">*</span>http.Request) {
	creq <span style="color:#555">:=</span> apps.CallRequest{}
	json.<span style="color:#c0f">NewDecoder</span>(req.Body).<span style="color:#c0f">Decode</span>(<span style="color:#555">&amp;</span>creq)
	code, _ <span style="color:#555">:=</span> creq.Values[<span style="color:#c30">&#34;code&#34;</span>].(<span style="color:#078;font-weight:bold">string</span>)

	token, _ <span style="color:#555">:=</span> <span style="color:#c0f">oauth2Config</span>(<span style="color:#555">&amp;</span>creq).<span style="color:#c0f">Exchange</span>(context.<span style="color:#c0f">Background</span>(), code)

	asActingUser <span style="color:#555">:=</span> mmclient.<span style="color:#c0f">AsActingUser</span>(creq.Context)
	asActingUser.<span style="color:#c0f">StoreOAuth2User</span>(creq.Context.AppID, token)

	json.<span style="color:#c0f">NewEncoder</span>(w).<span style="color:#c0f">Encode</span>(apps.CallResponse{})
}
</code></pre></div><h4 id="obtaining-an-oauth2-config-for-a-call">Obtaining an OAuth2 &ldquo;Config&rdquo; for a Call&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#obtaining-an-oauth2-config-for-a-call"></i></a> </h4>
<p>The App is responsible for composing its own remote OAuth2 config, using the
remote system-specific settings. The ClientID and ClientSecret are stored in
Mattermost OAuth2App record, and are included in the request Context if
specified with expand.oauth2_app=&quot;all&rdquo;.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#069;font-weight:bold">import</span> (
	<span style="color:#c30">&#34;golang.org/x/oauth2&#34;</span>
	<span style="color:#c30">&#34;golang.org/x/oauth2/google&#34;</span>
)

<span style="color:#069;font-weight:bold">func</span> <span style="color:#c0f">oauth2Config</span>(creq <span style="color:#555">*</span>apps.CallRequest) <span style="color:#555">*</span>oauth2.Config {
	<span style="color:#069;font-weight:bold">return</span> <span style="color:#555">&amp;</span>oauth2.Config{
		ClientID:     creq.Context.OAuth2.ClientID,
		ClientSecret: creq.Context.OAuth2.ClientSecret,
		Endpoint:     google.Endpoint,
		RedirectURL:  creq.Context.OAuth2.CompleteURL,
		Scopes: []<span style="color:#078;font-weight:bold">string</span>{
			<span style="color:#c30">&#34;https://www.googleapis.com/auth/calendar&#34;</span>,
			<span style="color:#c30">&#34;https://www.googleapis.com/auth/userinfo.profile&#34;</span>,
			<span style="color:#c30">&#34;https://www.googleapis.com/auth/userinfo.email&#34;</span>,
		},
	}
}
</code></pre></div><h3 id="send-command">send Command&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#send-command"></i></a> </h3>
<p><code>/hello-oauth2 send</code> sends the user a message that includes the Google user name
on the account, and lists the Google Calendars.</p>
<p>The form requests that submit calls expand &ldquo;oauth2_user&rdquo; which is where the app
stored the OAuth2 token upon a successful connect.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
	<span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;form&#34;</span>,
	<span style="color:#309;font-weight:bold">&#34;form&#34;</span>: {
		<span style="color:#309;font-weight:bold">&#34;title&#34;</span>: <span style="color:#c30">&#34;Send a Google-connected &#39;hello, world!&#39; message&#34;</span>,
		<span style="color:#309;font-weight:bold">&#34;icon&#34;</span>: <span style="color:#c30">&#34;http://localhost:8080/static/icon.png&#34;</span>,
		<span style="color:#309;font-weight:bold">&#34;call&#34;</span>: {
			<span style="color:#309;font-weight:bold">&#34;path&#34;</span>: <span style="color:#c30">&#34;/send&#34;</span>,
			<span style="color:#309;font-weight:bold">&#34;expand&#34;</span>: {
				<span style="color:#309;font-weight:bold">&#34;oauth2_user&#34;</span>: <span style="color:#c30">&#34;all&#34;</span>
			}
		}
	}
}
</code></pre></div><div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#069;font-weight:bold">func</span> <span style="color:#c0f">send</span>(w http.ResponseWriter, req <span style="color:#555">*</span>http.Request) {
	creq <span style="color:#555">:=</span> apps.CallRequest{}
	json.<span style="color:#c0f">NewDecoder</span>(req.Body).<span style="color:#c0f">Decode</span>(<span style="color:#555">&amp;</span>creq)

	oauthConfig <span style="color:#555">:=</span> <span style="color:#c0f">oauth2Config</span>(<span style="color:#555">&amp;</span>creq)
	token <span style="color:#555">:=</span> oauth2.Token{}
	<span style="color:#c0f">remarshal</span>(<span style="color:#555">&amp;</span>token, creq.Context.OAuth2.User) <span style="color:#09f;font-style:italic">// go JSON is quirky!
</span><span style="color:#09f;font-style:italic"></span>	ctx <span style="color:#555">:=</span> context.<span style="color:#c0f">Background</span>()
	tokenSource <span style="color:#555">:=</span> oauthConfig.<span style="color:#c0f">TokenSource</span>(ctx, <span style="color:#555">&amp;</span>token)
	oauth2Service, _ <span style="color:#555">:=</span> oauth2api.<span style="color:#c0f">NewService</span>(ctx, option.<span style="color:#c0f">WithTokenSource</span>(tokenSource))
	calService, _ <span style="color:#555">:=</span> calendar.<span style="color:#c0f">NewService</span>(ctx, option.<span style="color:#c0f">WithTokenSource</span>(tokenSource))
	uiService <span style="color:#555">:=</span> oauth2api.<span style="color:#c0f">NewUserinfoService</span>(oauth2Service)

	ui, _ <span style="color:#555">:=</span> uiService.V2.Me.<span style="color:#c0f">Get</span>().<span style="color:#c0f">Do</span>()
	message <span style="color:#555">:=</span> fmt.<span style="color:#c0f">Sprintf</span>(<span style="color:#c30">&#34;Hello from Google, [%s](mailto:%s)!&#34;</span>, ui.Name, ui.Email)
	cl, _ <span style="color:#555">:=</span> calService.CalendarList.<span style="color:#c0f">List</span>().<span style="color:#c0f">Do</span>()
	<span style="color:#069;font-weight:bold">if</span> cl <span style="color:#555">!=</span> <span style="color:#069;font-weight:bold">nil</span> <span style="color:#555">&amp;&amp;</span> <span style="color:#366">len</span>(cl.Items) &gt; <span style="color:#f60">0</span> {
		message <span style="color:#555">+=</span> <span style="color:#c30">&#34; You have the following calendars:\n&#34;</span>
		<span style="color:#069;font-weight:bold">for</span> _, item <span style="color:#555">:=</span> <span style="color:#069;font-weight:bold">range</span> cl.Items {
			message <span style="color:#555">+=</span> <span style="color:#c30">&#34;- &#34;</span> <span style="color:#555">+</span> item.Summary <span style="color:#555">+</span> <span style="color:#c30">&#34;\n&#34;</span>
		}
	} <span style="color:#069;font-weight:bold">else</span> {
		message <span style="color:#555">+=</span> <span style="color:#c30">&#34; You have no calendars.\n&#34;</span>
	}

	json.<span style="color:#c0f">NewEncoder</span>(w).<span style="color:#c0f">Encode</span>(apps.CallResponse{
		Markdown: md.<span style="color:#c0f">MD</span>(message),
	})
}
</code></pre></div><h2 id="hello-webhooks">Hello Webhooks!&nbsp;<a class="hanchor fa fa-link" ariaLabel="Anchor" href="#hello-webhooks"></i></a> </h2>


                </div>
            </div>
        </div>
    </div>
    <footer class="text-center">
    <div class="container-fluid">
        <div class="footer__copyright">© Mattermost, Inc. All Rights Reserved.</div>
        <div class="footer__icons">
            <a href="https://www.facebook.com/Mattermost-2300985916642531/" target="_blank" rel="noopener noreferrer" class="btn-primary"><i class="fa fa-facebook"></i></a>
            <a href="https://twitter.com/mattermost" target="_blank" rel="noopener noreferrer" class="btn-primary"><i class="fa fa-twitter"></i></a>
            <a href="https://www.youtube.com/channel/UCNR05H72hi692y01bWaFXNA" target="_blank" rel="noopener noreferrer" class="btn-primary"><i class="fa fa-youtube"></i></a>
        </div>
    </div>
</footer>


<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>
<script src="https://developers.mattermost.com/js/tabs.js"></script>
<script src="https://developers.mattermost.com/js/main.js"></script>

</body>
</html>
